[{"data":1,"prerenderedAt":214},["ShallowReactive",2],{"/blog/2024-03-01":3},{"id":4,"title":5,"body":6,"description":16,"extension":208,"meta":209,"navigation":103,"path":210,"seo":211,"stem":212,"__hash__":213},"blog/blog/2024-03-01.md","2024-03-01",{"type":7,"value":8,"toc":206},"minimark",[9,13,17,27,30,33,41,44,47,55,58,74,77,80,191,202],[10,11,5],"h1",{"id":12},"_2024-03-01",[14,15,16],"p",{},"Aujourd'hui, j'ai envie de tracer le chemin entre 2 stations, s'il existe.\nPar exemple, le joueur ajoute \"Rome\" qui",[18,19,20,24],"ul",{},[21,22,23],"li",{},"*est\nsur\nla\nligne\n2\n** et",[21,25,26],{},"*est\nadjacente\n** à Place de Clichy\nPuis ajoute à un autre moment \"Place de Clichy\", qui est sur la ligne 13 et 2, alors j'ajoute le chemin entre les 2\nstations.",[14,28,29],{},"Je stocke déjà toutes les stations ajoutées dans une Map,\nil reste alors au moment de l'ajout d'une nouvelle station de vérifier si elle n'est pas adjacente à une station déjà en\nplace.",[14,31,32],{},"Voyons un peu les données :",[18,34,35,38],{},[21,36,37],{},"Est-ce que les stations ont les lignes auxquelles elles appartiennent ?",[21,39,40],{},"Est-ce que les lignes ont quelque chose en commun avec ce qu'il y aurait dans les stations ?",[14,42,43],{},"Ah, mais je n'ai pas terminé l'extract des lignes.",[14,45,46],{},"J'y retourne. En regardant, il reste qu'à enregistrer, j'ai l'impression.",[14,48,49,50,54],{},"C'est bon, de retour sur le lien entre stations et lignes.\nJ'ai l'impression que c'est le\n",[51,52,53],"code",{},"properties.@relations.ref"," qui pourrait fonctionner,\nmais il ne faut pas oublier que ce n'est pas harmonisé (par exemple la ligne 9 ne vient pas du même contributeur).",[14,56,57],{},"En vérifiant avec cette commande cela m'a l'air correct :",[59,60,65],"pre",{"className":61,"code":62,"language":63,"meta":64,"style":64},"language-shell shiki shiki-themes github-light github-dark","cat assets/export.geojson | jq '.features | map(select(.properties.railway == \"stop\" or (.properties.public_transport == \"stop_position\" and .properties[\"type:RATP\"] == \"metro\")))' | rg -C 25 'Miromesnil'\n","shell","",[51,66,67],{"__ignoreMap":64},[68,69,72],"span",{"class":70,"line":71},"line",1,[68,73,62],{},[14,75,76],{},"Bon, par contre dans le merge des stations, je n'ai pas mergé les refs des lignes, je vais modifier le script.",[14,78,79],{},"Je modifie, le script et le lance",[59,81,85],{"className":82,"code":83,"language":84,"meta":64,"style":64},"language-javascript shiki shiki-themes github-light github-dark","const currentCoordinates = s.geometry.coordinates;\nconst currentLine = s.properties['@relations'].at(0).reltags.ref;\n\nif (stations.has(stationName)) {\n  const station = stations.get(stationName);\n  station.properties.coordinates.push(currentCoordinates);\n  if (currentLine)\n    station.properties.lines.add(currentLine);\n}\nelse {\n  s.properties.coordinates = [currentCoordinates];\n  s.properties.lines = new Set();\n\n  if (currentLine)\n    s.properties.lines.add(currentLine);\n\n  stations.set(stationName, s);\n}\n","javascript",[51,86,87,92,98,105,111,117,123,129,135,141,147,153,159,164,169,175,180,186],{"__ignoreMap":64},[68,88,89],{"class":70,"line":71},[68,90,91],{},"const currentCoordinates = s.geometry.coordinates;\n",[68,93,95],{"class":70,"line":94},2,[68,96,97],{},"const currentLine = s.properties['@relations'].at(0).reltags.ref;\n",[68,99,101],{"class":70,"line":100},3,[68,102,104],{"emptyLinePlaceholder":103},true,"\n",[68,106,108],{"class":70,"line":107},4,[68,109,110],{},"if (stations.has(stationName)) {\n",[68,112,114],{"class":70,"line":113},5,[68,115,116],{},"  const station = stations.get(stationName);\n",[68,118,120],{"class":70,"line":119},6,[68,121,122],{},"  station.properties.coordinates.push(currentCoordinates);\n",[68,124,126],{"class":70,"line":125},7,[68,127,128],{},"  if (currentLine)\n",[68,130,132],{"class":70,"line":131},8,[68,133,134],{},"    station.properties.lines.add(currentLine);\n",[68,136,138],{"class":70,"line":137},9,[68,139,140],{},"}\n",[68,142,144],{"class":70,"line":143},10,[68,145,146],{},"else {\n",[68,148,150],{"class":70,"line":149},11,[68,151,152],{},"  s.properties.coordinates = [currentCoordinates];\n",[68,154,156],{"class":70,"line":155},12,[68,157,158],{},"  s.properties.lines = new Set();\n",[68,160,162],{"class":70,"line":161},13,[68,163,104],{"emptyLinePlaceholder":103},[68,165,167],{"class":70,"line":166},14,[68,168,128],{},[68,170,172],{"class":70,"line":171},15,[68,173,174],{},"    s.properties.lines.add(currentLine);\n",[68,176,178],{"class":70,"line":177},16,[68,179,104],{"emptyLinePlaceholder":103},[68,181,183],{"class":70,"line":182},17,[68,184,185],{},"  stations.set(stationName, s);\n",[68,187,189],{"class":70,"line":188},18,[68,190,140],{},[14,192,193,194,197,198,201],{},"Hum, cela ne passe pas avec un\n",[51,195,196],{},"console.log",", je vois que la station\n",[51,199,200],{},"Marcadet - Poissonniers",", n'a pas de ref je peux\nme base sur quoi ?\nEn enquêtant sur la station, je me rends compte que j'ai déjà les deux lignes qui m'intéressent, que le Point geojson\nqui\nn'a pas de relation est du \"surplus\".\nJe vais faire en sorte de ne rien faire si je ne l'ai pas en espérant que ça soit suffisant.",[203,204,205],"style",{},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":64,"searchDepth":94,"depth":94,"links":207},[],"md",{"date":5},"/blog/2024-03-01",{"title":5,"description":16},"blog/2024-03-01","3IxbY8f2c8bzkskr3mkEiX6XNMmXP_qImsJxZaOWnS0",1752398829155]