<!DOCTYPE html><html  lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Metro Travel</title><style>/*! tailwindcss v4.1.11 | MIT License | https://tailwindcss.com */@layer properties{@supports ((-webkit-hyphens:none) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,::backdrop,:after,:before{--tw-font-weight:initial;--tw-leading:initial}}}.post h1{font-size:var(--text-4xl,2.25rem);line-height:var(--tw-leading,var(--text-4xl--line-height,1.11111));--tw-font-weight:var(--font-weight-bold,700);color:var(--color-gray-900,oklch(21% .034 264.665));font-weight:var(--font-weight-bold,700);padding-bottom:2rem}.post h2{font-size:var(--text-3xl,1.875rem);line-height:var(--tw-leading,var(--text-3xl--line-height,1.2));--tw-font-weight:var(--font-weight-semibold,600);color:var(--color-gray-800,oklch(27.8% .033 256.848));font-weight:var(--font-weight-semibold,600)}.post p{font-size:var(--text-base,1rem);line-height:var(--tw-leading,var(--text-base--line-height,1.5));--tw-leading:var(--leading-relaxed,1.625);color:var(--color-gray-700,oklch(37.3% .034 259.733));line-height:var(--leading-relaxed,1.625)}.post ul{list-style-position:inside;list-style-type:disc}.post a{color:var(--color-blue-600,oklch(54.6% .245 262.881));text-decoration-line:underline}@media (hover:hover){.post a:hover{color:var(--color-blue-800,oklch(42.4% .199 265.638))}}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-leading{syntax:"*";inherits:false}</style><style>pre code .line{display:block}</style><link rel="stylesheet" href="/_nuxt/entry.Bjo9vf1p.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/2024-03-02/_payload.json?c5cbf668-efa3-4a2b-99d9-a73dd68aa420"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B_RUHvC5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/p0j60SLX.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/0NVrhxl7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dm4Az773.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiQS8YBX.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BREgCDxA.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CF2n52tH.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DV7jJGjX.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bi6-AhX0.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B2zXwtR0.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/c5cbf668-efa3-4a2b-99d9-a73dd68aa420.json"><script src="https://analytics.vincenthardouin.dev/js/script.js" defer data-domain="metro-travel.vincenthardouin.dev"></script><link rel="prefetch" as="script" crossorigin href="/_nuxt/KXfNCXKJ.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/B36WBLqQ.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BwvhTdZ3.js"><meta hid="description" name="description" content="D√©fiez vos connaissances du m√©tro parisien chaque jour en trouvant le trajet optimal."><meta name="keywords" content="metro, paris, travel, challenge, game, daily, GTFS"><meta name="author" content="Vincent Hardouin"><meta name="robots" content="index, follow"><meta name="og:title" content="Metro travel"><link rel="icon" type="image/png" href="/favicon.png"><script type="module" src="/_nuxt/B_RUHvC5.js" crossorigin></script><script id="unhead:payload" type="application/json">{"title":"Metro Travel"}</script></head><body><div id="__nuxt"><div><body class="bg-gray-100 dark:bg-gray-900 font-sans transition-colors duration-300"><header class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-white/70 dark:bg-gray-800/70 backdrop-blur-lg px-3 py-3 rounded-full shadow-lg flex justify-between items-center z-10 w-[calc(100%-2rem)] max-w-[640px] mx-auto transition-colors duration-300"><div class="text-lg font-bold text-gray-800 dark:text-gray-200 whitespace-nowrap px-3"> üöá Metro Travel </div><div class="flex items-center gap-6"><ul class="flex gap-4 items-center"><li><a href="/" class="text-base font-medium hover:text-primary no-underline"> Accueil </a></li><li><a href="/blog" class="text-base font-medium hover:text-primary no-underline"> Blog </a></li></ul><a href="/training" class="btn btn-primary btn-sm shadow-none px-4 py-2 rounded-full text-sm font-semibold whitespace-nowrap"> S&#39;entra√Æner </a></div></header><!--[--><article class="post max-w-3xl mx-auto pt-34 py-12 px-4 prose prose-gray dark:prose-invert prose prose-lg dark:prose-invert leading-relaxed"><div><h1 id="_2024-03-02"><!--[-->2024-03-02<!--]--></h1><p><!--[-->Je commence √† √©crire la fonction qui va me permettre de relier les stations entre elles.
Je prends pour exemple : Stalingrad, Jaur√®s.<!--]--></p><p><!--[-->Le souci que j&#39;observe, c&#39;est que les stations bien qu&#39;adjacentes ne sont pas √† la suite
dans le tableau des coordonn√©es des lignes. Entre Jaur√®s et Stalingrad, il y a 15 points d&#39;√©cart.
Je suis emb√™t√©, je ne sais pas comment je vais faire pour savoir si les stations sont adjacentes entre elles.<!--]--></p><p><!--[-->Je vais essayer de voir si je peux trouver une solution en regardant les donn√©es.
C&#39;est tout √† fait normal que les stations ne soient pas adjacentes dans le tableau des coordonn√©es d&#39;une ligne,
comme on peut le voir avec mon exemple, o√π la ligne 2 n&#39;est pas une ligne droite √† ce moment-l√†.<!--]--></p><p><!--[-->Je me dis que je peux peut-√™tre ajouter l&#39;information dans les stations de m√©tro de leurs stations adjacentes.
L&#39;id√©e que j&#39;ai serai de faire un nouveau script dont voici le pseudo code :<!--]--></p><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span>- For each line
</span></span><span class="line" line="2"><span>    - Filter stationInLine in stations
</span></span><span class="line" line="3"><span>    - For each coordinates in line
</span></span><span class="line" line="4"><span>        - For each station in stationInLine
</span></span><span class="line" line="5"><span>            - If coordinates is in station
</span></span><span class="line" line="6"><span>                - Save station index
</span></span></code><!--]--></pre><p><!--[-->Ensuite gr√¢ce √† √ßa, j&#39;aurai les index des stations par rapport aux coordonn√©es de la ligne,
je pourrai donc chercher les stations adjacentes en prenant les index les plus proches.
√Ä voir si je veux faire un script, pour le calculer √† la vol√©e, ou si je veux le stocker dans un fichier.
Je pense le calculer une fois pour toutes, √ßa √©vitera d&#39;alourdir les calculs c√¥t√©s clients.<!--]--></p><p><!--[-->Le format que je souhaite avoir est le suivant :<!--]--></p><pre class="language-json shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">{
</span></span><span class="line" line="2"><span class="sj4cs">  &quot;adjacentStations&quot;</span><span class="sVt8B">: [
</span></span><span class="line" line="3"><span class="sZZnC">    &quot;station1&quot;</span><span class="sVt8B">,
</span></span><span class="line" line="4"><span class="sZZnC">    &quot;station2&quot;
</span></span><span class="line" line="5"><span class="sVt8B">  ]
</span></span><span class="line" line="6"><span class="sVt8B">}
</span></span></code><!--]--></pre><p><!--[-->Est-ce que j&#39;ai besoin de savoir sur quelle ligne sont les stations adjacentes ?
Je ne crois pas que √ßa soit utile, mais en m√™me temps pourquoi pas enregistrer l&#39;information comme je l&#39;ai donc avoir un
format du type :<!--]--></p><pre class="language-json shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span class="sVt8B">{
</span></span><span class="line" line="2"><span class="sj4cs">  &quot;adjacentStations&quot;</span><span class="sVt8B">: {
</span></span><span class="line" line="3"><span class="sj4cs">    &quot;2&quot;</span><span class="sVt8B">: [
</span></span><span class="line" line="4"><span class="sZZnC">      &quot;station1&quot;</span><span class="sVt8B">,
</span></span><span class="line" line="5"><span class="sZZnC">      &quot;station2&quot;
</span></span><span class="line" line="6"><span class="sVt8B">    ],
</span></span><span class="line" line="7"><span class="sj4cs">    &quot;3&quot;</span><span class="sVt8B">: [
</span></span><span class="line" line="8"><span class="sZZnC">      &quot;station2&quot;
</span></span><span class="line" line="9"><span class="sVt8B">    ]
</span></span><span class="line" line="10"><span class="sVt8B">  },
</span></span><span class="line" line="11"><span class="sj4cs">  &quot;inLineIndex&quot;</span><span class="sVt8B">: {
</span></span><span class="line" line="12"><span class="sj4cs">    &quot;2&quot;</span><span class="sVt8B">: </span><span class="sj4cs">17</span><span class="sVt8B">,
</span></span><span class="line" line="13"><span class="sj4cs">    &quot;7bis&quot;</span><span class="sVt8B">: </span><span class="sj4cs">3
</span></span><span class="line" line="14"><span class="sVt8B">  }
</span></span><span class="line" line="15"><span class="sVt8B">}
</span></span></code><!--]--></pre><p><!--[-->En √©crivant le script, je me rends compte que les multiline string ne me permettent pas de correctement calculer les
index des stations.<!--]--></p><p><!--[-->Je d√©cide de faire une fonction pour les afficher correctement :<!--]--></p><pre class="language-javascript shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span>function printLine(lineName) {
</span></span><span class="line" line="2"><span>  const line = lines.find((l) =&gt; {
</span></span><span class="line" line="3"><span>    return l.properties.ref === lineName;
</span></span><span class="line" line="4"><span>  });
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span>  const colors = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;, &#39;yellow&#39;, &#39;purple&#39;, &#39;orange&#39;, &#39;pink&#39;, &#39;brown&#39;, &#39;grey&#39;, &#39;black&#39;];
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span>  if (line.geometry.type === &#39;LineString&#39;) {
</span></span><span class="line" line="9"><span>    svg.append(&#39;path&#39;)
</span></span><span class="line" line="10"><span>      .datum(line)
</span></span><span class="line" line="11"><span>      .attr(&#39;d&#39;, d3.geoPath()
</span></span><span class="line" line="12"><span>        .projection(projection))
</span></span><span class="line" line="13"><span>      .attr(&#39;fill&#39;, &#39;none&#39;)
</span></span><span class="line" line="14"><span>      .attr(&#39;stroke&#39;, &#39;black&#39;)
</span></span><span class="line" line="15"><span>      .attr(&#39;stroke-width&#39;, 2);
</span></span><span class="line" line="16"><span>  }
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span>  if (line.geometry.type === &#39;MultiLineString&#39;) {
</span></span><span class="line" line="19"><span>    for (let i = 0; i &lt; line.geometry.coordinates.length; i++) {
</span></span><span class="line" line="20"><span>      for (let j = 0; j &lt; line.geometry.coordinates[i].length - 1; j++) {
</span></span><span class="line" line="21"><span>        svg.append(&#39;path&#39;)
</span></span><span class="line" line="22"><span>          .attr(&#39;d&#39;, d3.line()([projection(line.geometry.coordinates[i][j]), projection(line.geometry.coordinates[i][j + 1])]))
</span></span><span class="line" line="23"><span>          .attr(&#39;stroke&#39;, colors[i % colors.length])
</span></span><span class="line" line="24"><span>          .attr(&#39;stroke-width&#39;, 2)
</span></span><span class="line" line="25"><span>          .attr(&#39;fill&#39;, &#39;none&#39;);
</span></span><span class="line" line="26"><span>      }
</span></span><span class="line" line="27"><span>    }
</span></span><span class="line" line="28"><span>  }
</span></span><span class="line" line="29"><span>}
</span></span></code><!--]--></pre><p><!--[-->Voici le r√©sultat que j&#39;obtiens :<!--]--></p><p><!--[--><img src="assets/2024-03-02-lignes.png" alt="Lignes de m√©tro"><!--]--></p><p><!--[-->La fonction n&#39;est pas parfaite, elle utilise un
<code><!--[-->find<!--]--></code> au lieu d&#39;un
<code><!--[-->filter<!--]--></code> pour trouver la ligne.
Cela me permet de voir les multilinestring (en rouge et autres couleurs) et les lignes simples (en noir).
On voit bien que la boucle de la 7 bis n&#39;est pas √©vidente √† faire.
Je vais surement retirer la ligne 7 bis pour le moment, je vais me concentrer sur les lignes simples.<!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}</style></div></article><!--]--><footer class="fixed bottom-2 left-1/2 transform -translate-x-1/2 text-gray-500 dark:text-gray-400 text-sm bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg px-4 py-1 rounded-full shadow max-w-[90%] w-fit z-10 transition-colors duration-300"> ¬© 2025 <a href="https://github.com/VincentHardouin/metro-travel">Metro Travel</a> ‚Äì par <a href="https://vincenthardouin.dev">Vincent Hardouin</a></footer></body></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/2024-03-02/_payload.json?c5cbf668-efa3-4a2b-99d9-a73dd68aa420">[{"state":1,"once":3,"_errors":4,"serverRendered":6,"path":7,"prerenderedAt":8},["Reactive",2],{},["Set"],["ShallowReactive",5],{"/blog/2024-03-02":-1},true,"/blog/2024-03-02",1752398829151]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}}},app:{baseURL:"/",buildId:"c5cbf668-efa3-4a2b-99d9-a73dd68aa420",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>